<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Cache-Control" content="no-store, max-age=0" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/css/m2c2kit.css"
      rel="preload"
      as="style"
    />
    <link
      href="/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/css/m2c2kit.css"
      rel="stylesheet"
    />
    <link
      href="/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/css/defaultV2.css"
      rel="stylesheet"
    />
    <link
      href="/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/css/nouislider.css"
      rel="stylesheet"
    />
    <link
      href="/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/css/select2.css"
      rel="stylesheet"
    />
    <link
      href="/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/css/bootstrap-datepicker.standalone.css"
      rel="stylesheet"
    />
    <link
      href="/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/css/bootstrap-slider.css"
      rel="stylesheet"
    />
    <script type="module">
      const origLog = window.console.log;
      window.console.log = function (str) {
        origLog(str);
        const msg = {
          sender: "m2c2kitmsg",
          consoleId: undefined, // replace with console id
          text: str,
        };
        window.top.postMessage(msg, "*");
      };

      window.onerror = function (message, source, lineno, colno, error) {
        const msg = {
          sender: "m2c2kitmsg",
          consoleId: undefined, // replace with console id
          text: message,
          type: "error",
        };
        window.top.postMessage(msg, "*");
      };

      const { fetch: origFetch } = window;
      window.fetch = async (...args) => {
        if (args[0].startsWith("./assets/")) {
          args[0] = args[0].replace(
            "./assets/",
            "/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/"
          );
        } else if (args[0].startsWith("assets/")) {
          args[0] = args[0].replace(
            "assets/",
            "/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/assets/"
          );
        }
        return await origFetch(...args);
      };

      import {
        Scene,
        Game,
        Label,
        Session,
        EventType,
        ActivityType,
      } from "/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/lib/m2c2kit.core.esm.js";

      // _-_BEGIN_CODE_REPLACEMENT_BLOCK_-_
      import { SymbolSearch } from "/_-_BASE_URL_REPLACE_IN_DOCUSAURUS_BUILD_-_m2c2kit/lib/m2c2kit.assessment-symbol-search.esm.min.js";
      const activity = new SymbolSearch();
      // _-_END_CODE_REPLACEMENT_BLOCK_-_

      class ReloadMessage extends Game {
        constructor() {
          const options = {
            name: "reload",
            id: "docs",
            width: 400,
            height: 800,
            fonts: [
              {
                fontName: "roboto",
                url: "fonts/roboto/Roboto-Regular.ttf",
              },
            ],
          };
          super(options);
        }
        async initialize() {
          await super.initialize();
          const game = this;
          const sceneOne = new Scene();
          game.addScene(sceneOne);
          const reloadLabel = new Label({
            text: "Reload the page to try again",
            position: { x: 200, y: 400 },
          });
          sceneOne.addChild(reloadLabel);
        }
      }
      const reload = new ReloadMessage();

      const session = new Session({
        canvasKitWasmUrl: "canvaskit.wasm",
        activities: [activity, reload],
      });
      session.onActivityData((ev) => {
        if (ev.target.type === ActivityType.Game) {
          console.log(`✅ trial completed:`);
        } else if (ev.target.type === ActivityType.Survey) {
          console.log(`✅ survey response completed:`);
        }
        console.log("  newData: " + JSON.stringify(ev.newData));
        console.log("  data: " + JSON.stringify(ev.data));
      });
      window.session = session;
      session.initialize();
    </script>
  </head>

  <body class="m2c2kit-background-color m2c2kit-no-margin">
    <div id="m2c2kit-survey-div"></div>
    <div
      class="m2c2kit-full-viewport m2c2kit-flex-container"
      id="m2c2kit-container-div"
    >
      <canvas class="m2c2kit-full-viewport" id="m2c2kit-canvas"></canvas>
    </div>
  </body>
</html>
