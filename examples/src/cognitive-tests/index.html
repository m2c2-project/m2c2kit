<!DOCTYPE html>
<html>
  <head>
    <title>Dot memory</title>
    <style type="text/css">
      body {
        margin: 0;
      }
    </style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>

  <body style="background: white">
    <div
      style="
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        width: 100vw;
      "
    >
      <canvas style="height: 100vh; width: 100vw"></canvas>
      <!-- If you don't want the game to start immediately, remove game.start()
           from the code and call game.start() somehow else, such as with
           the button shown below or a programmatic call -->
      <button
        style="position: absolute; bottom: 8px; left: 8px"
        id="startButton"
        onclick="{
          document.getElementById('startButton').disabled = true;
          // we can set some game parameters here, or it will use built in defaults
          window.game.parameters = { ReadyTime: 500, DotPresentTime: 1000, TrialNum: 2};
          window.game.onTrialComplete((trialNumber, data, trialSchema) => {
            console.log(trialNumber);
            console.log(data);
            console.log(trialSchema);        

            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
            
                if (xhr.readyState !== 4) {
                  return;
                }

                if (xhr.status === 200) {
                  // we get the returned data
                  var data = xhr.responseText;
                  console.log('echo server response: ' + data);            
                }
            };

            var yourUrl = 'https://qsxoucw85l.execute-api.us-east-1.amazonaws.com/api/echo';
            xhr.open('POST', yourUrl, true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.send(JSON.stringify({ value: data }));
          });
          window.game.start();
        }"
      >
        Start
      </button>
    </div>
    <script type="module" src="./cognitive-tests.bundle.js"></script>
  </body>
</html>
